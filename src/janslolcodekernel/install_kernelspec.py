#!/usr/bin/env python
# *_* coding: utf-8 *_*

"""Kernel installer"""

import os
import shutil
from jupyter_client.kernelspec import KernelSpecManager

JSON ="""{"argv":["python","-m","janslolcodekernel", "-f", "{connection_file}"],
 "display_name":"LOLCODE"
}"""

SVG = """<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 300 300"
   version="1.1"
   id="svg4394"
   sodipodi:docname="lolcode.svg"
   width="300"
   height="300"
   inkscape:version="1.2.2 (732a01da63, 2022-12-09)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:dc="http://purl.org/dc/elements/1.1/">
  <defs
     id="defs4398" />
  <sodipodi:namedview
     id="namedview4396"
     pagecolor="#505050"
     bordercolor="#ffffff"
     borderopacity="1"
     inkscape:showpageshadow="0"
     inkscape:pageopacity="0"
     inkscape:pagecheckerboard="1"
     inkscape:deskcolor="#505050"
     showgrid="false"
     inkscape:zoom="2"
     inkscape:cx="105.25"
     inkscape:cy="97.5"
     inkscape:window-width="1920"
     inkscape:window-height="1009"
     inkscape:window-x="-8"
     inkscape:window-y="-8"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg4394" />
  <title
     id="title4360">file_type_lolcode</title>
  <g
     id="g4535"
     transform="matrix(10.713903,0,0,10.713903,-21.422448,-21.427805)">
    <path
       d="m 21.3,3.73 a 3.94,3.94 0 0 1 1.041,-0.62 8.435,8.435 0 0 1 0.556,3.385 24.865,24.865 0 0 1 -0.643,5.019 c -0.368,-0.18 -0.736,-0.364 -1.1,-0.554 A 11.754,11.754 0 0 0 21.427,7.213 3.08,3.08 0 0 0 21.172,6.348 5.142,5.142 0 0 0 19.156,8.418 C 18.837,8.178 18.504,7.959 18.171,7.742 A 15.716,15.716 0 0 1 21.3,3.73 Z"
       style="fill:#ededed"
       id="path4362" />
    <path
       d="M 19.451,8.6 A 4.574,4.574 0 0 1 20.96,7.037 6.685,6.685 0 0 1 21.05,9.708 C 20.517,9.343 19.975,8.987 19.451,8.6 Z"
       style="fill:#ededed"
       id="path4364" />
    <path
       d="M 16.461,10.076 C 16.423,8.942 16.43,7.708 16.435,6.577 c -0.9,0.493 -1.758,1.17 -2.648,1.688 -0.453,0.27 -0.908,0.536 -1.36,0.808 0.224,-0.163 0.457,-0.312 0.69,-0.462 -0.861,-1.224 -1.971,-2.5 -3.53,-2.748 -0.5294004,1.6621982 -0.6545321,3.4267271 -0.365,5.147 0.318,-0.195 0.633,-0.4 0.962,-0.572 -0.474,0.319 -0.964,0.615 -1.446,0.92 -0.957,0.6 -1.922,1.192 -2.892,1.777 -0.151041,0.07851 -0.2841736,0.187466 -0.391,0.32 -0.1,1.395 -0.34,4.392 -0.34,4.392 -0.254,3.668 -0.522,7.336 -0.826,11 4.062,0.343 8.118,0.82 12.179,1.154 -0.01,-6.623 0.004,-13.311 -0.007,-19.925 z"
       style="fill:#ededed"
       id="path4366"
       sodipodi:nodetypes="ccccccccccccccc" />
    <path
       d="M 21.1,2.977 A 5.884,5.884 0 0 1 22.706,2 10.064,10.064 0 0 1 23.478,6.606 24.591,24.591 0 0 1 22.97,11.065 c 1.2,0.846 2.433,1.645 3.618,2.509 q 0.44,6.38 0.907,12.758 c 0.066,0.839 0.094,1.68 0.216,2.513 -3.029,0.279 -6.057,0.591 -9.085,0.886 a 19.137,19.137 0 0 0 -2.158,0.27 v -0.083 c -0.01,-6.614 0,-13.227 -0.007,-19.841 -0.038,-1.134 -0.031,-2.269 -0.026,-3.4 v -0.1 c 0.406,0.292 0.826,0.562 1.243,0.839 A 16.274,16.274 0 0 1 21.1,2.977 Z m 0.2,0.752 A 15.716,15.716 0 0 0 18.172,7.74 c 0.334,0.217 0.666,0.437 0.985,0.676 a 5.142,5.142 0 0 1 2.016,-2.07 3.08,3.08 0 0 1 0.255,0.865 11.754,11.754 0 0 1 -0.273,3.747 c 0.364,0.19 0.731,0.374 1.1,0.554 A 24.865,24.865 0 0 0 22.898,6.493 8.435,8.435 0 0 0 22.342,3.108 3.94,3.94 0 0 0 21.3,3.73 Z M 19.451,8.6 c 0.524,0.383 1.066,0.739 1.6,1.108 A 6.685,6.685 0 0 0 20.961,7.037 4.574,4.574 0 0 0 19.451,8.6 Z"
       style="fill:#8d2701"
       id="path4368" />
    <path
       d="m 9.219,5.062 a 3.581,3.581 0 0 1 2.205,0.748 12.9,12.9 0 0 1 2.364,2.45 c -0.453,0.27 -0.908,0.536 -1.36,0.808 0.224,-0.163 0.457,-0.312 0.69,-0.462 -0.861,-1.224 -1.971,-2.5 -3.53,-2.748 a 10.964,10.964 0 0 0 -0.365,5.147 c 0.318,-0.195 0.633,-0.4 0.962,-0.572 -0.474,0.319 -0.964,0.615 -1.446,0.92 a 14.1,14.1 0 0 1 0.48,-6.291 z"
       style="fill:#8d2701"
       id="path4370" />
    <path
       d="m 10.507,8.476 a 2.455,2.455 0 0 1 1.517,0.88 l -0.36,0.2 A 2.69,2.69 0 0 0 10.739,9 3.318,3.318 0 0 0 10.574,10.281 l -0.344,0.11 a 7.021,7.021 0 0 1 0.277,-1.915 z"
       style="fill:#8d2701"
       id="path4372" />
    <path
       d="m 12.139,10.693 a 0.487,0.487 0 0 1 0.542,0.01 1.552,1.552 0 0 1 0.062,0.6 c -0.039,0.784 0.024,1.573 -0.076,2.354 a 1.013,1.013 0 0 1 -1.012,0.886 c -0.233,-0.05 -0.278,-0.341 -0.278,-0.541 0,-0.675 0.1,-1.347 0.066,-2.024 a 1.3,1.3 0 0 1 0.696,-1.285 z m 0.15,1.084 a 0.891,0.891 0 0 0 0.251,-0.866 c -0.322,0.15 -0.64,0.596 -0.251,0.866 z"
       style="fill:#8d2701"
       id="path4374" />
    <path
       d="m 14.5,13.728 a 17.671,17.671 0 0 1 1.928,-0.822 c -0.024,0.064 -0.069,0.191 -0.092,0.255 -0.649,0.358 -1.36,0.6 -2.021,0.938 A 12.118,12.118 0 0 0 11.077,16.347 7.2,7.2 0 0 1 10,17.381 4.166,4.166 0 0 1 10.98,16.135 12.727,12.727 0 0 1 14.5,13.728 Z"
       style="fill:#8d2701"
       id="path4376" />
    <path
       d="m 7.628,13.231 a 0.989,0.989 0 0 1 0.594,-0.152 18.114,18.114 0 0 1 -0.1,2.654 0.713,0.713 0 0 1 -0.892,0.658 21.1,21.1 0 0 1 0.082,-2.226 1.383,1.383 0 0 1 0.316,-0.934 z m 0.179,0.831 C 8.075,13.95 8.126,13.649 8.219,13.408 7.82,13.312 7.775,13.783 7.807,14.062 Z"
       style="fill:#8d2701"
       id="path4378" />
    <path
       d="m 10.823,17.094 a 13.934,13.934 0 0 1 4.612,-1.968 c -0.01,0.068 -0.029,0.206 -0.039,0.274 a 14.273,14.273 0 0 0 -4.475,1.914 2.626,2.626 0 0 1 -0.681,0.343 c 0.06,-0.301 0.36,-0.408 0.583,-0.563 z"
       style="fill:#8d2701"
       id="path4380" />
    <path
       d="M 5.264,17.59 A 5.144,5.144 0 0 1 8,17.1 1.5,1.5 0 0 1 9.142,17.765 6.854,6.854 0 0 0 7.6,17.278 6.967,6.967 0 0 0 5.116,17.842 Z"
       style="fill:#8d2701"
       id="path4382" />
    <path
       d="m 10.578,17.725 a 9.59,9.59 0 0 1 3.61,-0.566 c 0.24,0.021 0.321,0.2 0.313,0.424 a 3.238,3.238 0 0 0 -1.956,-0.09 21.688,21.688 0 0 0 -2.557,0.658 c 0.007,-0.322 0.357,-0.342 0.59,-0.426 z"
       style="fill:#8d2701"
       id="path4384" />
    <path
       d="M 9.268,17.676 C 9.417,17.5 9.801,17.344 9.932,17.614 A 1.3,1.3 0 0 1 9.416,18.607 C 9.268,18.337 8.973,17.952 9.268,17.676 Z"
       style="fill:#8d2701"
       id="path4386" />
    <path
       d="m 5.744,18.629 a 5.9,5.9 0 0 1 3.182,-0.618 c -0.182,0.235 -0.493,0.178 -0.751,0.208 a 5.663,5.663 0 0 0 -1.72,0.33 c -0.344,0.128 -0.665,0.31 -1.02,0.409 a 0.6,0.6 0 0 1 0.309,-0.329 z"
       style="fill:#8d2701"
       id="path4388" />
    <path
       d="M 6.9,19.114 A 9.676,9.676 0 0 1 9.1,18.26 C 9,18.56 8.659,18.598 8.4,18.704 A 7.839,7.839 0 0 0 5.836,20.119 C 5.938,19.584 6.488,19.369 6.9,19.114 Z"
       style="fill:#8d2701"
       id="path4390" />
    <path
       d="m 11.635,19.7 a 3.11,3.11 0 0 0 1.91,-1.383 c 0.347,-0.1 0.273,0.275 0.26,0.494 a 2.056,2.056 0 0 1 -0.95,1.036 12.365,12.365 0 0 1 -1.827,6.419 A 2.342,2.342 0 0 1 8.879,27.5 2.251,2.251 0 0 1 7.344,26.01 10.894,10.894 0 0 1 6.654,21.345 c -0.157,-0.112 -0.369,-0.179 -0.46,-0.362 -0.13,-0.2 0.011,-0.425 0.047,-0.631 0.19,0.151 0.345,0.392 0.606,0.42 A 3.617,3.617 0 0 0 8.71,20.372 1.588,1.588 0 0 0 9.419,19.71 3.881,3.881 0 0 0 9.85,19.976 4.28,4.28 0 0 0 11.635,19.7 Z m -2.2,0.835 a 4.132,4.132 0 0 1 -2.462,0.809 11.049,11.049 0 0 0 0.358,3.526 3.226,3.226 0 0 1 0.9,-1.282 2.055,2.055 0 0 1 2.3,-0.2 2.3,2.3 0 0 1 0.884,1.172 14.659,14.659 0 0 0 1.005,-4.489 5.167,5.167 0 0 1 -2.985,0.461 z m -0.329,3.26 a 2.273,2.273 0 0 0 -1.5,1.434 c -0.123,0.269 0.1,0.517 0.225,0.738 0.331,0.462 0.795,1 1.431,0.893 a 2.868,2.868 0 0 0 1.769,-1.6 1.6,1.6 0 0 0 -1.925,-1.468 z"
       style="fill:#8d2701"
       id="path4392" />
  </g>
  <metadata
     id="metadata4517">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:title>file_type_lolcode</dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
</svg>"""

def install_kernelspec():
    """Installs the jupyter lolcode kernel"""
    kerneldir = "/tmp/janslolcodekernel/"
    print('Creating tmp files...', end="")
    os.mkdir(kerneldir)

    with open(kerneldir + "kernel.json", "w", encoding="utf-8") as file:
        file.write(JSON)

    with open(kerneldir + "logo-svg.svg", "w", encoding="utf-8") as file:
        file.write(SVG)

    print(' Done!')
    print('Installing Jupyter kernel...', end="")

    ksm = KernelSpecManager()
    ksm.install_kernel_spec(kerneldir, 'janslolcodekernel', user=os.getenv('USER'))

    print(' Done!')
    print('Cleaning up tmp files...', end="")

    shutil.rmtree(kerneldir)

    print(' Done!')
    print('For uninstall use: jupyter kernelspec uninstall janslolcodekernel')
